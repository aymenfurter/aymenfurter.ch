<section id="projects">
    <div class="section-header">
        <h2>Featured Projects</h2>
        <p class="section-subtitle">Solution accelerators and AI experiments</p>
    </div>
    
    <!-- Project List -->
    <div class="project-list">
        {{ range $index, $project := sort (where .Site.RegularPages "Type" "projects") "Params.weight" }}
        <div class="project-item{{ if eq $index 0 }} active{{ end }}" data-project="{{ $project.File.ContentBaseName }}" data-media-type="{{ $project.Params.media_type }}">
            
            <!-- Collapsed View (Default) -->
            <div class="project-header">
                <div class="project-info">
                    <h3>{{ $project.Title }}</h3>
                    <p class="project-brief">{{ $project.Params.description }}</p>
                </div>
                <div class="project-meta">
                    <div class="tech-pills">
                        {{ range first 3 $project.Params.tags }}
                        <span class="tech-pill">{{ . }}</span>
                        {{ end }}
                    </div>
                    <a href="{{ $project.Params.github_repo }}" target="_blank" rel="noopener noreferrer" class="github-icon" aria-label="View on GitHub" onclick="event.stopPropagation();">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    </a>
                    <button class="expand-btn" aria-label="Expand project details">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Expanded View -->
            <div class="project-expanded">
                <div class="expanded-content">
                    <!-- Media -->
                    <div class="project-media">
                        {{ if eq $project.Params.media_type "video" }}
                        <video class="project-video" poster="/images/projects/{{ $project.File.ContentBaseName }}-poster.png" preload="metadata">
                            <source src="{{ $project.Params.media_url }}" type="video/mp4">
                        </video>
                        <button class="play-btn" aria-label="Play video">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                        <div class="video-controls">
                            <button class="mute-btn" aria-label="Toggle mute">
                                <svg class="icon-unmuted" viewBox="0 0 24 24" fill="currentColor"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                                <svg class="icon-muted" viewBox="0 0 24 24" fill="currentColor"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
                            </button>
                            <div class="progress-bar"><div class="progress-fill"></div></div>
                        </div>
                        {{ else }}
                        <img class="project-image" src="{{ $project.Params.media_url }}" alt="{{ $project.Title }}" loading="lazy">
                        {{ end }}
                    </div>

                    <!-- Details -->
                    <div class="project-details">
                        <div class="details-section">
                            <h4>Highlights</h4>
                            <ul class="highlights-list">
                                {{ range $project.Params.highlights }}
                                <li>{{ . }}</li>
                                {{ end }}
                            </ul>
                        </div>

                        <div class="details-section">
                            <h4>Stack</h4>
                            <div class="stack-list">
                                {{ range $project.Params.tech_details }}
                                <div class="stack-row">
                                    <span class="stack-key">{{ .name }}</span>
                                    <span class="stack-val">{{ .value }}</span>
                                </div>
                                {{ end }}
                            </div>
                            <div class="github-stats">
                                <a href="{{ $project.Params.github_repo }}" target="_blank" rel="noopener noreferrer" class="github-stars-link" data-repo="{{ $project.Params.github_repo }}">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"/></svg>
                                    <span class="stars-count" data-fallback="{{ $project.Params.stars }}">{{ $project.Params.stars }}</span>
                                    <span class="stars-label">stars on GitHub</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {{ end }}
    </div>
</section>